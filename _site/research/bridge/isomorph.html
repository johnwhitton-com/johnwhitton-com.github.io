<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Isomorph | John Whitton’s Site</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Isomorph" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Overview" />
<meta property="og:description" content="Overview" />
<link rel="canonical" href="https://johnwhitton-com.github.io/research/bridge/isomorph.html" />
<meta property="og:url" content="https://johnwhitton-com.github.io/research/bridge/isomorph.html" />
<meta property="og:site_name" content="John Whitton’s Site" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-24T00:00:00-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Isomorph" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-24T00:00:00-08:00","datePublished":"2023-02-24T00:00:00-08:00","description":"Overview","headline":"Isomorph","mainEntityOfPage":{"@type":"WebPage","@id":"https://johnwhitton-com.github.io/research/bridge/isomorph.html"},"url":"https://johnwhitton-com.github.io/research/bridge/isomorph.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/styles.css?v=">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    
<!-- <link rel="stylesheet" href="/assets/css/katex.min.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
</head>

<body>
    <div class="wrapper">
        <header>
            <a href="/index.html"><img src="/assets/images/jincubator.png"></a>
            <ul>
                <li><a href="/research">John's Research</a></li>
            </ul>
            <ul>
                <li><a href="/research/primitives/intro.html">Primitives</a></li>
                <ul>
                    
                    
                    <li><a href="/research/primitives/fast-fourier-transformations.html">Fast Fourier Transforms</a></li>
                    
                    <li><a href="/research/primitives/fraud-proofs.html">Fraud Proofs</a></li>
                    
                    <li><a href="/research/primitives/light-clients.html">Light Clients</a></li>
                    
                    <li><a href="/research/primitives/primitives.html">Cryptographic Primitives</a></li>
                    
                    <li><a href="/research/primitives/weak-subjectivity.html">Weak Subjectivity</a></li>
                    
                    <li><a href="/research/primitives/signatures.html">Signature Schemes in Consensus Protocols</a></li>
                    
                </ul>
            </ul>
            <ul>
                <li><a href="/research/zk/intro.html">Zero Knowledge</a></li>
                <ul>
                    
                    
                    <li><a href="/research/zk/zkpos.html">ZK Proof of Stake</a></li>
                    
                    <li><a href="/research/zk/zksnarks.html">zk-SNARKs</a></li>
                    
                </ul>
            </ul>
            <ul>
                <li><a href="/research/bridge/intro.html">Cross-chain Bridges</a></li>
                <ul>
                    
                    
                    <li><a href="/research/bridge/cosmos-ibc.html">Cosmos IBC</a></li>
                    
                    <li><a href="/research/bridge/harmony-horizon.html">Harmony Horizon</a></li>
                    
                    <li><a href="/research/bridge/isomorph.html">Isomorph</a></li>
                    
                    <li><a href="/research/bridge/near-rainbow.html">Near Rainbow Bridge</a></li>
                    
                    <li><a href="/research/bridge/polymerlabs.html">Polymer Labs</a></li>
                    
                    <li><a href="/research/bridge/snowbridge.html">Snowbridge</a></li>
                    
                    <li><a href="/research/bridge/succinct.html">Succinct Labs</a></li>
                    
                </ul>
            </ul>
            <ul>
                <li><a href="/research/chains/intro.html">Layer 1 Platforms</a></li>
                <ul>
                    
                    
                    <li><a href="/research/chains/avalanche.html">Avalanche</a></li>
                    
                    <li><a href="/research/chains/binance.html">Binance Smart Chain</a></li>
                    
                    <li><a href="/research/chains/cosmos.html">Cosmos</a></li>
                    
                    <li><a href="/research/chains/ethereum-1-0.html">Ethereum 1.0</a></li>
                    
                    <li><a href="/research/chains/ethereum.html">Ethereum</a></li>
                    
                    <li><a href="/research/chains/harmony.html">Harmony</a></li>
                    
                    <li><a href="/research/chains/near.html">NEAR</a></li>
                    
                    <li><a href="/research/chains/polkadot.html">Polkadot</a></li>
                    
                    <li><a href="/research/chains/polygon.html">Polygon</a></li>
                    
                </ul>
            </ul>
            <!-- <ul>
                <li><a href="/research/defi/intro.html">Decentralized Finance</a></li>
                <ul>
                    
                    
                </ul>
            </ul> -->
            <!-- <ul>
                <li><a href="/research/gaming/intro.html">Gaming</a></li>
                <ul>
                    
                    
                </ul>
            </ul> -->
            <ul>
                <li><a href="/research/code/intro.html">Code Reviews</a></li>
                <ul>
                    
                    
                    <li><a href="/research/code/Horizon.html">Horizon Bridge</a></li>
                    
                    <li><a href="/research/code/ethereum-near.html">Ethereum Near Bridging</a></li>
                    
                    <li><a href="/research/code/ethereum.html">Ethereum</a></li>
                    
                </ul>
            </ul>
            <!-- <ul>
                <li><a href="/research/misc/intro.html">Additional Research</a></li>
                <ul>
                    
                    
                </ul>
            </ul> -->
        </header>
        <section>
            <!-- <nav> -->
<table>
    <tr>
        
        <th>
            <a href="/" >Home</a>
            
        <th>
            <a href="/about.html" >About John</a>
            
        <th>
            <a href="/work.html" >Resume/CV</a>
            
        <th>
            <a href="/colleagues.html" >References</a>
            
        <th>
            <a href="/posts.html" >Writing</a>
            
        <th>
            <a href="/research.html" >Research</a>
            
        </th>
    </tr>
</table>
<!-- </nav> -->
            <style>
                sup {
                    font-size: 0.8rem;
                    position: relative;
                    top: -0.5rem;
                }
            </style>
            <h1>Isomorph</h1>
            <!-- <h6><h2 id="overview">Overview</h2>
</h6> -->
            <!-- <div>Feb 24th, 2023</div>
            <div></div>
            <div><i></i></div> --->
            <h2 id="overview">Overview</h2>

<p>Isomporph is a Zero Knowledge trustless multichain bridge.</p>

<h2 id="approach">Approach</h2>

<h2 id="sample-process-flow">Sample Process Flow</h2>

<p>At a high level when an event happens on chain 1 we want to trigger a corresponding action on chain 2.</p>

<p>For a simple bridging of funds this looks as follows</p>

<ol>
  <li>Alice deposits 100 TokenX into TokenLocker on Chain 1 (which are locked) **a1</li>
  <li>A transaction t1 is triggered in Block b1 and an event e1 is sent</li>
  <li>The relayer listens to event e1 and relays the transaction receipt information to Chain 2.</li>
  <li>Verifier verifies that t1 is in block b1</li>
  <li>Verifier verifies that block b1 is a valid block</li>
  <li>Verifier verifies that b1 is in Chain1 canoninical chain</li>
  <li>Executor1 triggers a minting of corresponding 100 TokenX∆ on TokenLocker∆ on Chain 2</li>
  <li>A transaction t2 is triggered in Block b2 and an event e2 is sent</li>
  <li>The relayer listens to event e2 and relays the transaction receipt information to Chain 1.</li>
  <li>Verifier verifies that t2 is in block b2</li>
  <li>Verifier verifies that block b2 is a valid block</li>
  <li>Verifier verifies that b2 is in Chain2 canoninical chain</li>
  <li>Executor2 marks the bridge transaction as complete</li>
</ol>

<h2 id="proof-components">Proof Components</h2>

<ul>
  <li>Valid Signers : Who are eligible to sign</li>
  <li>Valid Signature:</li>
  <li>Valid Block : (Epoch)</li>
</ul>

<h2 id="technology">Technology</h2>

<ul>
  <li>TokenLocker: <a href="https://github.com/johnwhitton/horizon/blob/refactorV2/src/eprover/txProof.js">horizon txProof.js</a> <a href="https://www.npmjs.com/package/eth-proof">npm EthProof</a></li>
  <li>TransactionVerify: Proves a <a href="https://ethereum.org/en/developers/docs/data-structures-and-encoding/patricia-merkle-trie/">Merkle Patricia Trie</a> using <a href="https://github.com/ethereum/consensus-specs/blob/dev/ssz/merkle-proofs.md">merkle Proof</a> which verifies the <a href="https://github.com/ethereum/go-ethereum/blob/release/1.9/core/types/transaction.go#L44">Transaction.Hash</a> against <a href="https://github.com/ethereum/go-ethereum/blob/release/1.9/core/types/block.go#L77">Header.txHash</a>. Here is an example from horizon using <a href="https://github.com/johnwhitton/horizon/blob/refactorV2/src/eprover/txProof.js">horizon txProof.js</a> which calls <a href="https://www.npmjs.com/package/eth-proof">npm EthProof</a>.</li>
  <li>BlockSignatureVerification
    <ul>
      <li>On Chain Verification : example is Near Rainbow Bridge Fraud Proof</li>
      <li>Optimistic</li>
      <li>Secure Enclave</li>
      <li>Zero Knowledge
        <ul>
          <li>Prover</li>
          <li>Verification</li>
        </ul>
      </li>
    </ul>
  </li>
  <li>BlockCanonicalVerification
    <ul>
      <li>Wait Number of Blocks</li>
      <li>Optimistic</li>
      <li>Light Client (Finality Gadgets)</li>
      <li>Finalized Epoch</li>
    </ul>
  </li>
  <li>EventLister</li>
  <li>Executor</li>
</ul>

<h2 id="proving-mechanisms">Proving Mechanisms</h2>

<h3 id="avalanche">Avalanche</h3>

<h3 id="binance">Binance</h3>

<h3 id="cosmos">Cosmos</h3>

<h3 id="ethereum">Ethereum</h3>

<h3 id="near">NEAR</h3>

<p>The leading NEAR Ethereum Bridge today Near Rainbow Bridge uses an optimistic approach.  Following is an excerpt from NearOnEthClient <sup id="fnref:near-1" role="doc-noteref"><a href="#fn:near-1" class="footnote" rel="footnote">1</a></sup>.</p>
<blockquote>
  <p>we adopt the optimistic <sup id="fnref:near-2" role="doc-noteref"><a href="#fn:near-2" class="footnote" rel="footnote">2</a></sup> approach where NearOnEthClient verifies everything in the NEAR header except the signatures. Then anyone can challenge a signature in a submitted header within a 4-hour challenge window. The challenge requires verification of a single Ed25519 signature which would cost about 500k Ethereum gas (expensive, but possible).</p>
</blockquote>

<h3 id="harmony">Harmony</h3>

<h3 id="polygon">Polygon</h3>

<h3 id="polkadot">Polkadot</h3>

<p>Previous proving mechanisms for Polkadot leverage BEEFY (Bridge Effiency Enabling Finality Yielder) <sup id="fnref:dot-3" role="doc-noteref"><a href="#fn:dot-3" class="footnote" rel="footnote">3</a></sup> an example is Snowbridge <sup id="fnref:dot-1" role="doc-noteref"><a href="#fn:dot-1" class="footnote" rel="footnote">4</a></sup> which developed their own Interactive Update Protocol <sup id="fnref:dot-2" role="doc-noteref"><a href="#fn:dot-2" class="footnote" rel="footnote">5</a></sup>.</p>

<h2 id="verification-mechanism">Verification Mechanism</h2>

<h2 id="relayer-mechanisms">Relayer Mechanisms</h2>

<h2 id="token-lockers">Token Lockers</h2>

<h2 id="references">References</h2>

<h2 id="appendices">Appendices</h2>

<h3 id="appendix-f-data-structures">Appendix F: Data Structures</h3>

<ul>
  <li>Block Structure from <a href="https://github.com/ethereum/go-ethereum/blob/release/1.9/core/types/block.go#L72">go-ethereum</a></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// SealHash returns the hash of a block prior to it being sealed.
func (ethash *Ethash) SealHash(header *types.Header) (hash common.Hash) {
 hasher := sha3.NewLegacyKeccak256()

 rlp.Encode(hasher, []interface{}{
  header.ParentHash,
  header.UncleHash,
  header.Coinbase,
  header.Root,
  header.TxHash,
  header.ReceiptHash,
  header.Bloom,
  header.Difficulty,
  header.Number,
  header.GasLimit,
  header.GasUsed,
  header.Time,
  header.Extra,
 })
 hasher.Sum(hash[:0])
 return hash
}
</code></pre></div></div>

<ul>
  <li>Transaction structure from <a href="https://github.com/ethereum/go-ethereum/blob/release/1.9/core/types/transaction.go#LL39-L64C2">go-ethereum</a></li>
</ul>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>type Transaction struct {
 data txdata    // Consensus contents of a transaction
 time time.Time // Time first seen locally (spam avoidance)

 // caches
 hash atomic.Value
 size atomic.Value
 from atomic.Value
}

type txdata struct {
 AccountNonce uint64          `json:"nonce"    gencodec:"required"`
 Price        *big.Int        `json:"gasPrice" gencodec:"required"`
 GasLimit     uint64          `json:"gas"      gencodec:"required"`
 Recipient    *common.Address `json:"to"       rlp:"nil"` // nil means contract creation
 Amount       *big.Int        `json:"value"    gencodec:"required"`
 Payload      []byte          `json:"input"    gencodec:"required"`

 // Signature values
 V *big.Int `json:"v" gencodec:"required"`
 R *big.Int `json:"r" gencodec:"required"`
 S *big.Int `json:"s" gencodec:"required"`

 // This is only used when marshaling to JSON.
 Hash *common.Hash `json:"hash" rlp:"-"`
}
</code></pre></div></div>

<h2 id="footnotes">FootNotes</h2>
<!-- Overview -->

<!-- Approach -->

<!-- Proving Mechanisms -->

<!-- Avalanche -->

<!-- Binance -->

<!-- Cosmos -->

<!-- Ethereum -->

<!-- NEAR -->

<!-- Harmony -->

<!-- Polygon -->

<!-- Polkadot -->

<!-- Verification Mechanism -->

<!-- Relayer Mechanisms -->

<!-- Token Lockers -->
<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:near-1" role="doc-endnote">
      <p><a href="https://near.org/blog/eth-near-rainbow-bridge/">NEAR: ETH-NEAR Rainbow Bridge</a>: a bridge, called Rainbow Bridge, to connect the Ethereum and NEAR blockchains. <a href="#fnref:near-1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:near-2" role="doc-endnote">
      <p><a href="https://medium.com/@deaneigenmann/optimistic-contracts-fb75efa7ca84">Optimistic Contracts</a>: contracts that accept all information as fact until proven to be non-factual. This allows for a reduction in the cost of verifying data, as on-chain verification would only be necessary when one is sure that the data is false. <a href="#fnref:near-2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:dot-3" role="doc-endnote">
      <p><a href="https://spec.polkadot.network/#sect-grandpa-beefy">Polkadot: BEEFY</a>: The BEEFY (Bridge Effiency Enabling Finality Yielder) is a secondary protocol to GRANDPA to support efficient bridging between the Polkadot network (relay chain) and remote, segregated blockchains, such as Ethereum, which were not built with the Polkadot interchain operability in mind. <a href="#fnref:dot-3" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:dot-1" role="doc-endnote">
      <p><a href="https://docs.snowbridge.network/architecture/verification/polkadot">SnowBridge: Polkadot Verification</a>: use Polkadot’s BEEFY gadget to implement an efficient light client that only needs to verify a very small subset of relay chain validator signatures. <a href="#fnref:dot-1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
    <li id="fn:dot-2" role="doc-endnote">
      <p><a href="https://docs.snowbridge.network/architecture/verification/polkadot/interactive-update-protocol">Snowbridge: Interactive Update Protocol</a>: A prover wants to convince a light client that at least <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">1/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">1/3</span></span></span></span>  of validators signed a statement, which they claim that a specific set of at least <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>2</mn><mi mathvariant="normal">/</mi><mn>3</mn></mrow><annotation encoding="application/x-tex">2/3</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">2/3</span></span></span></span> of validators do. <a href="#fnref:dot-2" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

        </section>
    </div>
</body>

</html>