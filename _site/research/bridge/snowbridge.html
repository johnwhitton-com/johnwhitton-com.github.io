<!doctype html>
<html lang="en-US">

<head>
    <meta charset="utf-8">
    <!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Snowbridge | John Whitton’s Site</title>
<meta name="generator" content="Jekyll v4.3.2" />
<meta property="og:title" content="Snowbridge" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="Overview" />
<meta property="og:description" content="Overview" />
<link rel="canonical" href="http://localhost:4000/research/bridge/snowbridge.html" />
<meta property="og:url" content="http://localhost:4000/research/bridge/snowbridge.html" />
<meta property="og:site_name" content="John Whitton’s Site" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2023-02-24T00:00:00-08:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Snowbridge" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2023-02-24T00:00:00-08:00","datePublished":"2023-02-24T00:00:00-08:00","description":"Overview","headline":"Snowbridge","mainEntityOfPage":{"@type":"WebPage","@id":"http://localhost:4000/research/bridge/snowbridge.html"},"url":"http://localhost:4000/research/bridge/snowbridge.html"}</script>
<!-- End Jekyll SEO tag -->

    <link rel="stylesheet" href="/assets/css/styles.css?v=">
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    
<!-- <link rel="stylesheet" href="/assets/css/katex.min.css"> -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css">
</head>

<body>
    <div class="wrapper">
        <header>
            <a href="/index.html"><img src="/assets/images/jincubator.png"></a>
            <ul>
                <li><a href="/research">John's Research</a></li>
            </ul>
            <ul>
                <li><a href="/research/primitives/intro.html">Primitives</a></li>
                <ul>
                    
                    
                    <li><a href="/research/primitives/fast-fourier-transformations.html">Fast Fourier Transforms</a></li>
                    
                    <li><a href="/research/primitives/fraud-proofs.html">Fraud Proofs</a></li>
                    
                    <li><a href="/research/primitives/light-clients.html">Light Clients</a></li>
                    
                    <li><a href="/research/primitives/primitives.html">Cryptographic Primitives</a></li>
                    
                    <li><a href="/research/primitives/weak-subjectivity.html">Weak Subjectivity</a></li>
                    
                    <li><a href="/research/primitives/signatures.html">Signature Schemes in Consensus Protocols</a></li>
                    
                </ul>
            </ul>
            <ul>
                <li><a href="/research/zk/intro.html">Zero Knowledge</a></li>
                <ul>
                    
                    
                    <li><a href="/research/zk/zkpos.html">ZK Proof of Stake</a></li>
                    
                    <li><a href="/research/zk/zksnarks.html">zk-SNARKs</a></li>
                    
                </ul>
            </ul>
            <ul>
                <li><a href="/research/bridge/intro.html">Cross-chain Bridges</a></li>
                <ul>
                    
                    
                    <li><a href="/research/bridge/cosmos-ibc.html">Cosmos IBC</a></li>
                    
                    <li><a href="/research/bridge/harmony-horizon.html">Harmony Horizon</a></li>
                    
                    <li><a href="/research/bridge/isomorph.html">Isomorph</a></li>
                    
                    <li><a href="/research/bridge/near-rainbow.html">Near Rainbow Bridge</a></li>
                    
                    <li><a href="/research/bridge/polymerlabs.html">Polymer Labs</a></li>
                    
                    <li><a href="/research/bridge/snowbridge.html">Snowbridge</a></li>
                    
                    <li><a href="/research/bridge/succinct.html">Succinct Labs</a></li>
                    
                </ul>
            </ul>
            <ul>
                <li><a href="/research/chains/intro.html">Layer 1 Platforms</a></li>
                <ul>
                    
                    
                    <li><a href="/research/chains/avalanche.html">Avalanche</a></li>
                    
                    <li><a href="/research/chains/binance.html">Binance Smart Chain</a></li>
                    
                    <li><a href="/research/chains/cosmos.html">Cosmos</a></li>
                    
                    <li><a href="/research/chains/ethereum-1-0.html">Ethereum 1.0</a></li>
                    
                    <li><a href="/research/chains/ethereum.html">Ethereum</a></li>
                    
                    <li><a href="/research/chains/harmony.html">Harmony</a></li>
                    
                    <li><a href="/research/chains/near.html">NEAR</a></li>
                    
                    <li><a href="/research/chains/polkadot.html">Polkadot</a></li>
                    
                    <li><a href="/research/chains/polygon.html">Polygon</a></li>
                    
                </ul>
            </ul>
            <!-- <ul>
                <li><a href="/research/defi/intro.html">Decentralized Finance</a></li>
                <ul>
                    
                    
                </ul>
            </ul> -->
            <!-- <ul>
                <li><a href="/research/gaming/intro.html">Gaming</a></li>
                <ul>
                    
                    
                </ul>
            </ul> -->
            <ul>
                <li><a href="/research/code/intro.html">Code Reviews</a></li>
                <ul>
                    
                    
                    <li><a href="/research/code/Horizon.html">Horizon Bridge</a></li>
                    
                    <li><a href="/research/code/ethereum-near.html">Ethereum Near Bridging</a></li>
                    
                    <li><a href="/research/code/ethereum.html">Ethereum</a></li>
                    
                </ul>
            </ul>
            <!-- <ul>
                <li><a href="/research/misc/intro.html">Additional Research</a></li>
                <ul>
                    
                    
                </ul>
            </ul> -->
        </header>
        <section>
            <!-- <nav> -->
<table>
    <tr>
        
        <th>
            <a href="/" >Home</a>
            
        <th>
            <a href="/about.html" >About John</a>
            
        <th>
            <a href="/work.html" >Resume/CV</a>
            
        <th>
            <a href="/colleagues.html" >References</a>
            
        <th>
            <a href="/posts.html" >Writing</a>
            
        <th>
            <a href="/research.html" >Research</a>
            
        </th>
    </tr>
</table>
<!-- </nav> -->
            <style>
                sup {
                    font-size: 0.8rem;
                    position: relative;
                    top: -0.5rem;
                }
            </style>
            <h1>Snowbridge</h1>
            <!-- <h6><h2 id="overview">Overview</h2>
</h6> -->
            <!-- <div>Feb 24th, 2023</div>
            <div></div>
            <div><i></i></div> --->
            <h2 id="overview">Overview</h2>

<p>Snowbridge is a general purpose, trustless and decentralized bridge between Polkadot and Ethereum. The goal is to launch as common-good bridge on the proposed BridgeHub parachain.
<strong>Quick Links</strong></p>

<ul>
  <li>Bridge Type : Proof Based Validity Proofs</li>
  <li><a href="https://docs.snowbridge.network/architecture/overview">Design</a>: bridge has a layered architecture, inspired by networking protocols such as TCP/IP. At the lowest level we have channels, which send messages across the bridge. At the highest level, we have apps, which can invoke methods on apps living on foreign chains.</li>
  <li><a href="https://docs.snowbridge.network/">Docs</a>: Snowbridge documentation</li>
  <li><a href="https://github.com/Snowfork/snowbridge">Implementation snowfork snowbridge</a>: A trustless bridge between Polkadot and Ethereum.</li>
  <li>FronteEnd: Still Under Development</li>
  <li><a href="https://polkadot.subscan.io/parachain">Explorer</a>: Can be used to review if a common good parachain is deployed. Bridge messages will be displayed as Cross Chain Messages (XCM) on this <a href="https://polkadot.subscan.io/xcm_dashboard">xcm dashboard</a>.</li>
  <li><a href="https://gateway.pinata.cloud/ipfs/QmfYGxQvyjVrgm9ajfzCysbuvLXdsRxP5R5HFjWcrj2yYY">Roadmap</a>: The <a href="https://polkadot.polkassembly.io/post/1341">Snowbridge Funding Proposal</a> includes a link to the <a href="(&lt;https://gateway.pinata.cloud/ipfs/QmfYGxQvyjVrgm9ajfzCysbuvLXdsRxP5R5HFjWcrj2yYY&gt;)">roadmap</a> which details the milestones and rollout.</li>
</ul>

<h2 id="design-notes">Design Notes</h2>

<p><strong><a href="https://docs.snowbridge.network/architecture/verification/polkadot">light-client verification polkadot</a></strong></p>

<p>We use Polkadot’s BEEFY gadget to implement an efficient light client that only needs to verify a very small subset of relay chain validator signatures. BEEFY is live on Rococo, and is awaiting deployment on Kusama and Polkadot.
Fundamentally, the BEEFY light client allows the bridge to prove that a specified parachain header was finalized by the relay chain.</p>

<p><strong><a href="https://github.com/paritytech/parity-bridges-common/blob/master/modules/beefy/src/lib.rs">BEEFY light client</a></strong></p>

<blockquote>
  <p>BEEFY bridge pallet.</p>

  <p>This pallet is an on-chain BEEFY light client for Substrate-based chains that are using the following pallets bundle: <code class="language-plaintext highlighter-rouge">pallet-mmr</code>, <code class="language-plaintext highlighter-rouge">pallet-beefy</code> and <code class="language-plaintext highlighter-rouge">pallet-beefy-mmr</code>.</p>

  <p>The pallet is able to verify MMR leaf proofs and BEEFY commitments, so it has access to the following data of the bridged chain:</p>

  <ul>
    <li>header hashes</li>
    <li>changes of BEEFY authorities</li>
    <li>extra data of MMR leafs</li>
  </ul>

  <p>Given the header hash, other pallets are able to verify header-based proofs (e.g. storage proofs, transaction inclusion proofs, etc.).</p>
</blockquote>

<p><strong><a href="https://docs.snowbridge.network/architecture/verification/ethereum">light-client verification ethereum</a></strong></p>

<p>We have implemented a Proof-of-Stake (PoS) light client for the Beacon chain. This  client deprecates the older PoW light client we developed in 2020.</p>

<p>The beacon client tracks the beacon chain, the new Ethereum chain that will replace Ethereum’s Proof-of-Work consensus method around mid-September, called the Merge. The work we have done consists of the following parts:</p>

<ul>
  <li>Beacon Client pallet
    <ul>
      <li>Initial chain snapshot (forms part of the Genesis Config)</li>
      <li>Sync committee updates</li>
      <li>Finalized beacon header updates</li>
      <li>Execution header updates</li>
      <li>Message verification</li>
    </ul>
  </li>
  <li>Beacon Relayer
    <ul>
      <li>Sends data from a beacon node to the beacon client</li>
    </ul>
  </li>
</ul>

<h2 id="code-review">Code Review</h2>

<h3 id="signing-mechanisms">Signing Mechanisms</h3>

<ul>
  <li><a href="https://www.secg.org/sec2-v2.pdf">secp256k1</a>
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/tree/main/relayer/crypto/secp256k1">snowbridge secp256k1</a></li>
    </ul>
  </li>
  <li><a href="https://wiki.polkadot.network/docs/learn-cryptography#what-is-sr25519-and-where-did-it-come-from">sr25519</a>: schnorr over ristretto25519
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/tree/main/relayer/crypto/secp256k1">snowbridge sr25519</a></li>
    </ul>
  </li>
</ul>

<h3 id="cryptographic-primitives">Cryptographic Primitives</h3>

<ul>
  <li><a href="https://keccak.team/keccak.html">keccak256</a> hash function
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/crypto/keccak/keccak.go">snowbridge keccak</a></li>
    </ul>
  </li>
  <li><a href="https://en.wikipedia.org/wiki/Merkle_tree">merkle trees</a>
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/crypto/merkle/merkle.go">snowbridge merkle.go</a></li>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/parachain/pallets/ethereum-beacon-client/src/merkleization.rs">snowbridge merkleization.rs</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/ethereum/consensus-specs/blob/dev/ssz/merkle-proofs.md">merkle_proof</a> <a href="https://soliditydeveloper.com/merkle-tree">explainer</a>
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/crypto/merkle/simplified_mmr_proof.go">snowbridge simplified_mmr_proof.go</a></li>
      <li><a href="https://github.com/Snowfork/snowbridge/tree/main/parachain/pallets/basic-channel/merkle-proof">snowbridge merkle-proof rust</a></li>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/core/packages/contracts/contracts/utils/MerkleProof.sol">snowbridge MerkleProof.sol</a></li>
    </ul>
  </li>
  <li><a href="https://docs.grin.mw/wiki/chain-state/merkle-mountain-range/">Merkle Mountain Range</a>
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/core/packages/contracts/contracts/utils/MMRProof.sol">snowbridge MMRProof.sol</a></li>
      <li><a href="https://github.com/Snowfork/merkle-mountain-range">snowfork merkle-mountain-range</a></li>
    </ul>
  </li>
  <li><a href="https://ethereum.org/en/developers/docs/data-structures-and-encoding/ssz/">Simple Serialize</a>
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/parachain/pallets/ethereum-beacon-client/src/ssz.rs">snowbridge ssz.rs</a></li>
    </ul>
  </li>
</ul>

<h3 id="proving-mechanisms">Proving Mechanisms</h3>

<ul>
  <li><a href="https://wiki.polkadot.network/docs/learn-consensus#bridging-beefy">Beefy</a>
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/core/packages/contracts/contracts/BeefyClient.sol">snowbridge BeefyClient.sol</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/Snowfork/snowbridge/tree/main/parachain/pallets/ethereum-beacon-client">snowbridge ethereum-beacon-client rust</a></li>
  <li><a href="https://github.com/Snowfork/snowbridge/tree/main/parachain/pallets/ethereum-light-client">snowbridge ethereum-light-client rust</a></li>
</ul>

<h3 id="relayer-mechanisms">Relayer Mechanisms</h3>

<p>The <a href="https://github.com/Snowfork/snowbridge/tree/main/relayer/relays">relays folder</a> has multiple relayers controlled by <a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/execution/main.go">execution</a>. All written in go.</p>

<ul>
  <li>Relaying from Ethereum to Polkadot
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/tree/main/relayer/relays/beacon">beacon</a>: Responsible for retrieving state from the beacon chain including
        <ul>
          <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go">synching</a>:
            <ul>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L47">Header</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L55">CurrentSyncCommittee</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#LL60C12-L60C12">SyncAggregate</a></li>
            </ul>
          </li>
          <li>functions include
            <ul>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L65">GetSyncPeriodsToFetch</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L83">GetInitialSync</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L118">GetSyncCommitteePeriodUpdate</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L187">GetBlockRoots</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L252">GetFinalizedUpdate</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L305">HasFinalizedHeaderChanged</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L326">GetLatestFinalizedHeader</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L379">getNextBlockRootBySlot</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L425">GetNextHeaderUpdateBySlotWithAncestryProof</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L434">GetNextHeaderUpdateBySlot</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L457">GetHeaderUpdateWithAncestryProof</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L495">getBlockHeaderAncestryProof</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L520">GetSyncAggregate</a></li>
              <li><a href="https://github.com/Snowfork/snowbridge/blob/main/relayer/relays/beacon/header/syncer/syncer.go#L534">GetSyncAggregateForSlot</a></li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a href="https://github.com/Snowfork/snowbridge/tree/main/relayer/relays/ethereum">ethereum</a>: Responsible for retreiving block headers from the execution chain.</li>
    </ul>
  </li>
  <li>Relaying from Polkadot to Etherem
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/tree/main/relayer/relays/parachain">parachain</a></li>
      <li><a href="https://github.com/Snowfork/snowbridge/tree/main/relayer/relays/beefy">beefy</a></li>
    </ul>
  </li>
</ul>

<h3 id="light-client-functionality">Light Client Functionality</h3>

<ul>
  <li><a href="https://wiki.polkadot.network/docs/learn-consensus#bridging-beefy">Beefy</a>
    <ul>
      <li><a href="https://github.com/Snowfork/snowbridge/blob/main/core/packages/contracts/contracts/BeefyClient.sol">snowbridge BeefyClient.sol</a></li>
    </ul>
  </li>
  <li><a href="https://github.com/Snowfork/snowbridge/tree/main/parachain/pallets/ethereum-beacon-client">snowbridge ethereum-beacon-client rust</a></li>
  <li><a href="https://github.com/Snowfork/snowbridge/tree/main/parachain/pallets/ethereum-light-client">snowbridge ethereum-light-client rust</a></li>
</ul>

<h3 id="token-lockers">Token Lockers</h3>

<ul>
  <li><a href="https://github.com/Snowfork/snowbridge/blob/main/core/packages/contracts/contracts/ERC20Vault.sol">snowbridge ERC20Vault.sol</a></li>
</ul>

<h2 id="references">References</h2>

<h2 id="appendices">Appendices</h2>

        </section>
    </div>
</body>

</html>